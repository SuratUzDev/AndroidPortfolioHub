import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

// Get current directory in ESM
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Create uploads directory if it doesn't exist
const uploadsDir = path.join(__dirname, 'public', 'uploads');
if (!fs.existsSync(uploadsDir)) {
  fs.mkdirSync(uploadsDir, { recursive: true });
}

// This is a 100x100 colored placeholder PNG (more visible than a transparent 1x1 pixel)
const betterPlaceholderData = Buffer.from([
  0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, 0x00, 0x00, 0x00, 0x0D,
  0x49, 0x48, 0x44, 0x52, 0x00, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00, 0x64,
  0x08, 0x06, 0x00, 0x00, 0x00, 0x70, 0xE2, 0x95, 0x54, 0x00, 0x00, 0x00,
  0x01, 0x73, 0x52, 0x47, 0x42, 0x00, 0xAE, 0xCE, 0x1C, 0xE9, 0x00, 0x00,
  0x00, 0x04, 0x67, 0x41, 0x4D, 0x41, 0x00, 0x00, 0xB1, 0x8F, 0x0B, 0xFC,
  0x61, 0x05, 0x00, 0x00, 0x00, 0x09, 0x70, 0x48, 0x59, 0x73, 0x00, 0x00,
  0x0E, 0xC3, 0x00, 0x00, 0x0E, 0xC3, 0x01, 0xC7, 0x6F, 0xA8, 0x64, 0x00,
  0x00, 0x00, 0x16, 0x49, 0x44, 0x41, 0x54, 0x78, 0x5E, 0xED, 0xC1, 0x01,
  0x01, 0x00, 0x00, 0x00, 0x82, 0x20, 0xFF, 0xAF, 0x6E, 0x48, 0x40, 0x01,
  0x00, 0x00, 0x00, 0xEF, 0x06, 0x10, 0x20, 0x00, 0x01, 0x31, 0xD1, 0x3D,
  0x50, 0x00, 0x00, 0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, 0xAE, 0x42, 0x60,
  0x82
]);

// Create the better placeholder image
const betterPlaceholderPath = path.join(uploadsDir, 'better-placeholder.png');
fs.writeFileSync(betterPlaceholderPath, betterPlaceholderData);

// Also create category-specific placeholders
const folders = ['apps', 'blog', 'profile', 'general'];
for (const folder of folders) {
  const folderPath = path.join(uploadsDir, folder);
  if (!fs.existsSync(folderPath)) {
    fs.mkdirSync(folderPath, { recursive: true });
  }
  
  const categoryPlaceholderPath = path.join(folderPath, 'category-placeholder.png');
  fs.writeFileSync(categoryPlaceholderPath, betterPlaceholderData);
}

console.log(`Created better placeholder images!`);